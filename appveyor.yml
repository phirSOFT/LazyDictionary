skip_tags: true
image: Visual Studio 2017
configuration: Release

skip_commits:
  message: /\[WIP\]/

install:
  - cinst gitversion.portable
  - nuget restore
  - ps: gitversion /l console /output buildserver

assembly_info:
  patch: false

dotnet_csproj:
  patch: true
  file: '**\*.csproj'
  version: $(GitVersion_FullSemVer)
  package_version: $(GitVersion_FullSemVer)
  assembly_version: $(GitVersion_AssemblySemVer)
  file_version: $(GitVersion_AssemblySemVer)
  informational_version: $(GitVersion_FullSemVer)

on_failure:
  - ps: 7z a "WorkingTree.zip"
  - ps: Push-AppveyorArtifact WorkingTree.zip

build:
  publish_nuget: true
  publish_nuget_symbols: true
  include_nuget_references: true
  parallel: true
  verbosity: minimal

deploy:
- provider: GitHub
  auth_token:
    secure: zSOGlECwz3ZYOh1TRGkP5mrljlAgtlxaVfGlieOfgv3YkO/e3s1NX/HQkQefhYis
  on:
    branch: master
- provider: NuGet
  api_key:
    secure: TwWHVdjcJdEIGimzcMeGdskjvEfDYM/R1FFZWAvkQQbz13lf16QxhiXSTGTJO0zW
  on:
    branch: master